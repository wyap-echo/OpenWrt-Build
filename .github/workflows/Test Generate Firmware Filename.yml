name: Test Generate Firmware Filename

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code ğŸ› ï¸
      uses: actions/checkout@main
      # æ£€å‡ºä»£ç 

    - name: Generate firmware filename ğŸ“
      id: generate_filename
      run: |
        # ä½¿ç”¨å›ºå®šçš„ç‰ˆæœ¬å·
        VERSION="immortalwrt-21.02"
        # è¾“å‡ºæ—¶é—´æˆ³ï¼Œç¡®ä¿ä¼ é€’æ­£ç¡®
        echo "Timestamp: ${{ github.event.head_commit.timestamp }}"
        # ä½¿ç”¨æ­£ç¡®çš„æ–¹å¼æ ¼å¼åŒ–æ—¶é—´æˆ³
        TIMESTAMP=$(date -d @${{ github.event.head_commit.timestamp }} '+%Y%m%d')
        # ç”Ÿæˆå®Œæ•´çš„æ–‡ä»¶å
        FILENAME="RAX3000M_mediatek_mt7981_${VERSION}-${{ github.run_id }}-${TIMESTAMP}"
        echo "Generated firmware filename: $FILENAME"
        echo "FILENAME=$FILENAME" >> $GITHUB_ENV
      # ä»…éªŒè¯æ–‡ä»¶åç”Ÿæˆ

    - name: Output the generated firmware filename
      run: |
        echo "The generated firmware filename is: ${{ env.FILENAME }}"
      # è¾“å‡ºæ–‡ä»¶åï¼Œæ£€æŸ¥æ˜¯å¦æ­£ç¡®ç”Ÿæˆ
